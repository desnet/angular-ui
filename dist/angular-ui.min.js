(function(){var uis=angular.module("ui",["ui.tpls","ng"]);uis.directive("uiBusy",["$timeout","$templateCache",function(a,b){return{restrict:"A",replace:!1,scope:{value:"=uiBusy"},link:function(c,d){function e(){d.css("position","relative"),d.append(i)}function f(){j&&d.css("position",j),i.remove()}function g(){a.cancel(h),f()}var h,i=angular.element(b.get("ui-busy.html")),j=d.css("position");c.$watch("value",function(b){b&&(b.$promise&&"function"==typeof b.$promise.then?(h=a(e,400),b.$promise.then(g)):"function"==typeof b.then&&(h=a(e,400),b.then(g)))},!0)}}}]),uis.directive("uiCaptcha",[function(){function a(){this.getToken(),this.reload()}return a.prototype.reload=function(){this.code="",this.url="?token="+this.token+"&time="+(new Date).getTime()},a.prototype.getToken=function(){for(var a="",b="0123456789abcdef",c=0,d=b.length-1,e=0;16>e;++e)c=Math.floor(Math.random()*d),a+=b.substring(c,c+1);return this.token=a,a},{restrict:"AE",replace:!0,templateUrl:"ui-captcha.html",scope:{model:"=uiModel"},link:function(b,c,d){b.captcha=new a,b.src=d.src||"",d.uiModel&&"{"!=d.uiModel.charAt(0)&&(b.model=b.captcha),b.$watch("captcha.url",function(){b.update=!0}),c.find("img").load(function(){b.$apply(function(){b.update=!1})})}}}]),uis.directive("uiCheckbox",function(){return{priority:0,require:"^ngModel",restrict:"EA",replace:!0,transclude:!0,templateUrl:"ui-combo-box.html",scope:{value:"=",marked:"=uiMarked"},link:function(a,b,c,d){a.checked=!1,d.$render=function(){a.checked=angular.isUndefined(a.value)?d.$viewValue:a.value==d.$viewValue},a.toggle=function(){return c.disabled?!1:(a.checked=angular.isUndefined(a.value)?!a.checked:a.value==d.$viewValue?"":a.value,void d.$setViewValue(a.checked))}}}}),uis.directive("uiComboBox",["$document",function(a){return{restrict:"E",require:"^ngModel",replace:!0,templateUrl:"ui-combobox.html",scope:{options:"=uiOptions"},link:function(b,c,d,e){b.nodes=b.options&&b.options.data,b.isDisabled=b.options&&b.options.disabled,b.selected={},b.open=function(a){a.preventDefault(),a.stopPropagation(),b.isOpen=b.isDisabled?!1:!b.isOpen},b.select=function(a){b.selected=a,e.$setViewValue(a.value)},e.$render=function(){for(var a=0;a<b.nodes.length;a++)if(b.nodes[a].value==e.$viewValue){b.selected=b.nodes[a];break}},a.on("click",function(a){b.isOpen&&(b.isOpen=!1,b.$apply())})}}}]),uis.directive("uiCompareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=uiCompareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b==a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}),uis.directive("uiConfirm",["$document","$compile","$templateCache",function(a,b,c){function d(a){var b=this;this.$scope=a.$new(),this.$scope.cancel=function(){angular.isFunction(b.onCancel)&&b.onCancel(),b.hide()},this.$scope.success=function(){angular.isFunction(b.onSuccess)&&b.onSuccess(),b.hide()},this.title="",this.content=""}return d.prototype={template:c.get("ui-confirm.html"),show:function(){this.$scope.title=this.title,this.$scope.content=this.content,this.$confirm=b(this.template)(this.$scope),this.$confirm.appendTo(a.find("body"))},hide:function(){this.$confirm.remove()}},{restrict:"A",scope:!0,link:function(a,b,c){var e=new d(a);b.on("click",function(){e.show()}),a.$watch(c.uiConfirm,function(a){angular.extend(e,a)})}}}]),uis.directive("uiDatepicker",["$document",function(a){return{restrict:"AE",transclude:!0,replace:!0,templateUrl:"ui-date-picker.html",scope:{value:"=uiModel",cfg:"=uiDatepicker",opt:"=uiOptions"},controller:function(a){var b=a.cfg||a.opt;if(a.config={empty:!1,daysOfYear:!1,limitFrom:null,limitTo:null},angular.isObject(b))for(var c in a.config)b[c]&&(a.config[c]="limitFrom"==c||"limitTo"==c?new Date(b[c]):b[c]);a.isPrev=!0,a.isNext=!0,a.isPrevYear=!0,a.isNextYear=!0,a.config.daysOfYear&&(a.isPrevYear=!1,a.isNextYear=!1),a.prev=function(){a.isPrev&&a.buildCalendar(a.date.setMonth(a.date.getMonth()-1)),a.config.daysOfYear&&new Date(a.date.getFullYear(),a.date.getMonth()-1).getFullYear()!=a.date.getFullYear()&&(a.isPrev=!1),a.isNext||(a.isNext=!0)},a.prevYear=function(){a.isPrevYear&&a.buildCalendar(a.date.setYear(a.date.getFullYear()-1))},a.next=function(){a.isNext&&a.buildCalendar(a.date.setMonth(a.date.getMonth()+1)),a.config.daysOfYear&&new Date(a.date.getFullYear(),a.date.getMonth()+1).getFullYear()!=a.date.getFullYear()&&(a.isNext=!1),a.isPrev||(a.isPrev=!0)},a.nextYear=function(){a.isNextYear&&a.buildCalendar(a.date.setYear(a.date.getFullYear()+1))},a.today=function(){a.buildCalendar(),a.isNext=!0,a.isPrev=!0},a.getDayOfYear=function(a,b){return a=new Date(a),angular.isUndefined(b)?parseInt((a.getTime()-new Date(a.getFullYear(),0,0).getTime())/864e5):864e5*b+new Date(a.getFullYear(),0,0).getTime()},a.buildCalendar=function(b){var c=b?new Date(b):new Date,d=new Date(c),e=d.getMonth(),f=d.getYear(),g=[];for(d.setDate(1),a.config.daysOfYear&&d.setHours(0),d.setDate(0===d.getDay()?-6:d.getDate()-d.getDay()),1===d.getDate()&&d.setDate(-6);g.length<6&&!(c.getYear()===f&&c.getMonth()>e);){for(var h=[],i=0;7>i;i++)h.push({day:d.getTime(),selected:a.selected.indexOf(d.getTime())>=0,disabled:a.config.daysOfYear&&d.getYear()!=f||a.config.limitFrom&&d.getTime()<a.config.limitFrom.getTime()||a.config.limitTo&&d.getTime()>a.config.limitTo.getTime(),notCurrentMonth:d.getMonth()!=e,notCurrentYear:d.getYear()!=f}),d.setDate(d.getDate()+1);g.push(h)}a.date=c,a.weeks=g},a.selectDay=function(b){if(b.disabled)return!1;if(angular.isArray(a.value)){var c=a.selected.indexOf(b.day);if(b.selected=0>c,b.selected?a.selected.push(b.day):a.selected.splice(c,1),a.config.daysOfYear){a.value.splice(0,a.value.length);for(var d=0;d<a.selected.length;d++)a.value.push(a.getDayOfYear(a.selected[d]))}else a.value=angular.copy(a.selected)}else{if(a.config.daysOfYear)a.value=a.getDayOfYear(b.day);else if(a.value){var e=new Date(a.value);a.value=new Date(b.day).setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}else a.value=b.day;a.selected.splice(0,a.selected.length,a.value),a.selecting=!a.selecting,a.buildCalendar(a.value)}},a.days=["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],a.weeks=[]},link:function(b,c,d){if(b.selected=angular.isArray(b.value)&&b.value.length?angular.copy(b.value):!angular.isArray(b.value)&&b.value?[angular.copy(b.value)]:[],b.config.daysOfYear)for(var e=new Date,f=0;f<b.selected.length;f++)b.selected[f]=b.getDayOfYear(e,b.selected[f]);b.selected.length||b.config.empty||b.selected.push(b.config.daysOfYear?(new Date).setHours(0):(new Date).getTime()),b.selectDate=function(){return b.disabled?!1:(b.selecting=!b.selecting,void c.children("div").css("top",c.offset().top+c.outerHeight()-a.scrollTop()))},b.buildCalendar(b.selected[0]),c.on("click",function(b){b.stopPropagation(),a.triggerHandler("click",this)}),a.on("click",function(a,d){d!=c[0]&&b.selecting&&b.$apply(function(){b.selecting=!1})}),d.$observe("disabled",function(a){b.disabled=a})}}}]),uis.directive("uiFormError",["$document","$parse","$compile","$translate","uiTooltipDirective",function(a,b,c,d,e){return angular.extend({},e[0],{priority:0,require:["^form","^?ngModel","uiTooltip"],compile:function(){return function(a,c,e,f){function g(a){if(d&&!m.template){var b=[],c=["ERRORS"].concat(h.split(".")),e=c.length;for(var f in a)for(var g=0;e>g;g++)b.push(c.concat([f.replace(/^ui([A-Z].+)/,"$1")]).join(".").toUpperCase()),c.pop();d(b).then(function(a){for(var c=0;c<b.length;c++)if(a[b[c]]!=b[c]){k.show(a[b[c]]);break}})}else k.show(m.template||h,!0)}var h,i=f.shift(),j=f.shift(),k=f.shift(),l=0,m={field:"",location:"right",template:""};if(e.uiFormError&&("{"==e.uiFormError.charAt(0)?angular.extend(m,b(e.uiFormError)(a)):m.field=e.uiFormError,m.field&&(l=m.field.split(".").length)),l>1)h=m.field;else{if(!i||1==l&&!j)throw new Error;h=i.$name+"."+(1==l?m.field:j.$name)}if(!b(h)(a))throw new Error;k.location=m.location,a.$watch(h+".$error",function(a){angular.equals(a,{})?(c.off("mouseout mouseover"),k.hide()):(c.filter(":focus").length&&g(a),c.on("mouseout",function(){k.hide()}),c.on("mouseover",function(){g(a)}))},!0)}}})}]),uis.directive("uiHighlight",["$window",function(a){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"ui-highlight.html",link:function(b,c,d){var e=c.children();a.hljs.highlightBlock(e[0])}}}]),uis.directive("uiHtml",["$compile","$timeout",function(a,b){return{restrict:"AE",link:function(a,c,d){c.html()&&b(function(){a.$apply(function(){a[d.uiHtml]=c.html().replace(/^\s+|\s+$/gm,"")})},0)}}}]),uis.directive("isolatedForm",function(){return{restrict:"A",require:"form",link:function(a,b,c,d){var e=b.parent().controller("form"),f=d.$setValidity;d.$setValidity=function(a,b,c){f(a,b,c),!b&&e&&e.$setValidity(a,!0,d)}}}}),uis.directive("uiList",[function(){return{require:"^ngModel",restrict:"AE",replace:!0,templateUrl:"ui-list-box.html",scope:!0,compile:function(a,b){var c=angular.element(a.context.innerHTML);return 1==c.length&&c[0].tagName&&"li"==c[0].tagName.toLowerCase()?(a.contents().remove(),a.append(c)):a.contents().append(a.context.innerHTML),a.contents().attr("ng-repeat","node in nodes"+(b.filter?" | "+b.filter:"")),function(a,b,c,d){d.$render=function(){a.nodes=d.$viewValue},a.$watchCollection("nodes",function(){d.$validate()})}}}}]),uis.directive("uiModal",["$document",function(a){return{restrict:"AE",replace:!0,templateUrl:"ui-modal.html",transclude:!0,link:function(a,b,c){var d=b.children(),e=d.outerWidth(),f=d.outerHeight();d.css({width:e,"margin-left":-parseInt(e/2)+"px","margin-top":-parseInt(f/2)-30+"px"})}}}]),function(a,b){var c=100,d="noBind-DestroyMe",e=function(a,b){return function(e){var f=function(g,h){var i=this;if(h||"function"!=typeof g){var j=a(g)(i);null===j||void 0===j||0===j?b(function(){f.apply(i,[g,h])},c,!1):(h(j,g.exp),e[d]=!0)}else g()};e.$watch=f}},f=function(a,b){var e=function(){b[d]?a(function(){b.$destroy()},0,!0):a(e,c,!1)};e()};b.directive("uiNoBind",function(a,b){return{restrict:"A",priority:999999,scope:!0,controller:e(a,b),link:{pre:function(a,b,c){},post:function(a,c,d){c.removeClass("ng-binding"),c.removeClass("ng-scope"),c.find("*").removeClass("ng-binding"),c.find("*").removeClass("ng-scope"),f(b,a)}}}}),b.directive("uiNoBindChildren",function(a,b,c){return{restrict:"A",priority:999999,compile:function(d,g){var h,i=d[0].innerHTML;return d.empty(),{pre:function(d,f,g){h=d.$new(),e(a,b)(h);var j=c("<div>"+i+"</div>")(h).children();f.append(j)},post:function(a,c,d){c.find("*").removeClass("ng-binding"),c.find("*").removeClass("ng-scope"),f(b,h)}}}}})}(angular,uis),uis.directive("uiNotify",["$timeout",function(a){return{restrict:"AE",replace:!0,templateUrl:"ui-notify.html",scope:{config:"=uiNotify",notify:"=uiModel"},link:function(b,c){var d;b.hide=function(){c.hide(),b.isShow=!1},b.config=angular.extend({autohide:0},b.config),b.$watch("notify",function(e){null===e||angular.isUndefined(e)||(b.hide(),b.notify=null,b.text=e,c.show(),a(function(){b.$apply(function(){c.css("margin-left",-parseInt(c.innerWidth()/2)),b.isShow=!0})},0),d&&(a.cancel(d),d=!1),b.config.autohide&&(d=a(b.hide,b.config.autohide)))})}}}]),uis.directive("uiRowGroup",[function(){return{restrict:"AE",link:function(a,b,c){function d(){return e||b.children().length-1}var e=0;b.addClass("group"),a.groupToggle=function(a){a&&a.preventDefault&&a.preventDefault(),d()>0&&b.toggleClass("opened")},c.uiRowGroup?a.$watch(c.uiRowGroup,function(a){a&&!angular.isUndefined(a.length)&&(e=a.length),d()<1&&b.removeClass("opened")}):d()<1&&b.removeClass("opened")}}}]),uis.directive("uiScrollBar",function(){return{restrict:"A",link:function(a,b){}}}),uis.directive("uiSpinner",[function(){return{require:"ngModel",restrict:"AE",replace:!0,templateUrl:"ui-spinner.html",scope:{options:"=uiSpinnerOptions"},link:function(a,b,c,d){var e=a.options;return a.plus=function(){a.model++},a.minus=function(){a.model--},a.$watch("model",function(b,c){(!String(b).match(/^(\-)?(\d*)$/)||e&&("number"==typeof e.max&&b>e.max||"number"==typeof e.min&&b<e.min))&&(b=c,a.model=c),d.$setViewValue(b)}),d.$render=function(){return d.$viewValue?a.model=d.$viewValue:(d.$setViewValue(0),a.model=0),a.model},d.$render}}}]),uis.directive("uiStrength",function(){return{restrict:"A",replace:!0,template:'<div ng-class="strength.state"><div style="width: {{strength.pct}}%;"></div></div>',scope:{strength:"=uiStrength",pwd:"=uiModel"},link:function(a){function b(a){var b=0;return a.length<5?b+=7:a.length>4&&a.length<8?b+=14:a.length>7&&a.length<16?b+=17:a.length>15&&(b+=23),a.match(/[a-z]/)&&(b+=9),a.match(/[A-Z]/)&&(b+=10),a.match(/\d+/)&&(b+=10),a.match(/(.*[0-9].*[0-9].*[0-9])/)&&(b+=10),a.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(b+=10),a.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(b+=10),a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(b+=7),a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)&&(b+=7),a.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(b+=15),b>100?100:b}function c(a){switch(Math.round(a/33)){case 0:case 1:return"danger";case 2:return"warning";case 3:return"success"}}a.strength={},a.$watch("pwd",function(){var d=b(a.pwd||"");a.strength.pct=d,a.strength.state=c(d)})}}}),uis.directive("uiSwitcher",["$timeout",function(a){return{require:"ngModel",restrict:"AE",replace:!0,templateUrl:"ui-switcher.html",scope:{},link:function(b,c,d,e){function f(){return b.model=e.$viewValue,b.model}return b.toggle=function(){return e.$setViewValue(!e.$viewValue),f()},e.$render=function(){return f()},a(function(){b.init=!0},1e3),e.$render}}}]),uis.directive("uiTime",["$filter",function(a){return{require:"ngModel",restrict:"AE",replace:!0,templateUrl:"ui-time.html",scope:!0,link:function(b,c,d,e){b.pattern="(2[0-3]|[0-1][0-9]):([0-5][0-9])",b.$watch("value",function(a){var b,c,d=String(a).split(":");2==d.length?(e.$viewValue?c=new Date(e.$viewValue):(c=new Date,c.setHours(0,0)),b=new Date(c),b.setHours(parseInt(d[0]),parseInt(d[1])),b.getTime()!=c.getTime()&&e.$setViewValue(b)):""===a&&e.$setViewValue(null)}),e.$render=function(){b.value=a("date")(new Date(e.$viewValue),"HH:mm")}}}}]),uis.directive("uiTooltip",["$window","$document","$compile","$parse","$timeout","$sce","$templateCache",function(a,b,c,d,e,f,g){function h(a,b){this.$element=b,this.$scope=a.$new()}var i=angular.element(a);return h.prototype={delay:100,disabled:!1,location:"right",locations:["top","bottom","left","right"],include:!1,content:"",template:g.get("ui-tooltip.html"),setContent:function(a,b){"#"==a.charAt(0)?(this.$scope.include=a.substr(1),this.$scope.content=!1):(this.$scope.include=!1,this.$scope.content=f.trustAsHtml(a)),b&&this.$scope.$apply(),angular.isElement(this.$tooltip)&&e(angular.bind(this,this.reposition),0)},show:function(a,d){return this.disabled?!1:(a||(a=this.content),this.delayTimer?(e.cancel(this.delayTimer),delete this.delayTimer,!0):(angular.isElement(this.$tooltip)||(this.$tooltip=c(this.template)(this.$scope),this.$tooltip.appendTo(b.find("body")),this.$tooltip.on("mouseover",angular.bind(this,function(){this.hover=!0,this.show(a,d)})),this.$tooltip.on("mouseout",angular.bind(this,function(){this.hover=!1,this.hide()}))),void(a?this.setContent(a,d):e(angular.bind(this,this.reposition),0))))},hide:function(){angular.isElement(this.$tooltip)&&!this.hover&&(this.delayTimer=e(angular.bind(this,function(){this.$tooltip.css({top:0,left:-1e3}).remove(),delete this.$tooltip,delete this.delayTimer}),this.delay))},reposition:function(){var a,c=this.location,d=this.$element.offset(),e={};this.$tooltip.removeClass("bottom right top left"),this.$tooltip.addClass("top"),e.top={top:d.top-this.$tooltip.outerHeight(!0),left:d.left+this.$element.outerWidth()/2-this.$tooltip.outerWidth(!0)/2},e.top.right=e.top.left+this.$tooltip.outerWidth(),this.$tooltip.removeClass("top"),this.$tooltip.addClass("bottom"),e.bottom={top:d.top+this.$element.outerHeight(),left:d.left+this.$element.outerWidth()/2-this.$tooltip.outerWidth(!0)/2},e.bottom.bottom=e.bottom.top+this.$tooltip.outerHeight(!0),e.bottom.right=e.bottom.left+this.$tooltip.outerWidth(!0),this.$tooltip.removeClass("bottom"),this.$tooltip.addClass("left"),e.left={top:d.top+this.$element.outerHeight()/2-this.$tooltip.outerHeight(!0)/2,left:d.left-this.$tooltip.outerWidth(!0)},e.left.bottom=e.left.top+this.$tooltip.outerHeight(!0),this.$tooltip.removeClass("left"),this.$tooltip.addClass("right"),e.right={top:d.top+this.$element.outerHeight()/2-this.$tooltip.outerHeight(!0)/2,left:d.left+this.$element.outerWidth()},e.right.bottom=e.right.top+this.$tooltip.outerHeight(!0),e.right.right=e.right.left+this.$tooltip.outerWidth(!0),this.$tooltip.removeClass("right"),a={top:e.top.top<b.scrollTop()||e.top.left<0||e.top.right>b.scrollLeft()+i.width(),bottom:e.bottom.bottom>b.scrollTop()+i.height()||e.bottom.left<0||e.bottom.right>b.scrollLeft()+i.width(),left:e.left.left<0||e.left.top<b.scrollTop()||e.left.bottom>b.scrollTop()+i.height(),right:e.right.right>b.scrollLeft()+i.width()||e.right.top<b.scrollTop()||e.right.bottom>b.scrollTop()+i.height()};for(var f=c.indexOf(this.locations),g=0;a[c]&&g!=this.locations.length;)g++,f=++f%this.locations.length,c=this.locations[f];this.$tooltip.addClass(c+" show"),this.$tooltip.css({left:Math.round(e[c].left),top:Math.round(e[c].top)})}},{restrict:"A",controller:["$scope","$element",h],link:function(a,b,c,e){var f={},g={disabled:!1,delay:100,location:"right",include:!1,content:""};"{"==c.uiTooltip.charAt(0)?f=d(c.uiTooltip)(a):f.content=c.uiTooltip;for(var h in g)e[h]=f[h]?f[h]:c["uiTooltip"+h.substring(0,1).toUpperCase()+h.substring(1,h.length)]?c["uiTooltip"+h.substring(0,1).toUpperCase()+h.substring(1,h.length)]:g[h];b.on("mouseout",function(){e.hide()}).on("mouseover",function(){e.show(null,!0)})}}}]),uis.directive("uiTreeView",["$compile",function(a){return{restrict:"AE",scope:{treeView:"=uiTreeView",nodes:"=uiModel"},controller:function(a){function b(){var c=this.$parent.$parent,d=!1;if(c.node&&this.depth>0){for(var e=0;e<c.node[a.config.children].length;e++)if(c.node[a.config.children][e].$checked||c.node[a.config.children][e].$marked){d=!0;break}c.node.$marked=d,c.depth>0&&b.call(c)}}function c(){var b=this.$parent.$parent,c=!1;if(b.node&&this.depth>0){for(var d=0;d<b.node[a.config.children].length;d++)if(b.node[a.config.children][d].$checked){c=!0;break}b.node.$checked=c,a.config.onChange.call(b.node),b.depth>0&&a.checkParents.call(b)}}a.config=angular.extend({children:"children",onChange:angular.noop},a.treeView),a.toggleNode=function(a){a.$expand=!a.$expand},a.checkChildren=function(){var b=this;angular.forEach(b.node[a.config.children],function(c){c.$checked=b.node.$checked,a.config.onChange.call(c),a.checkChildren.call(b,c)})},a.checkParents=function(){a.config.onChange.call(this.node),c.call(this)},a.checkAll=function(){a.checkChildren.call(this),a.config.onChange.call(this.node),c.call(this)},a.markParents=function(){a.config.onChange.call(this.node),b.call(this)}},compile:function(b){var c=angular.element(b.html());return b.contents().remove(),function(b,d,e,f){c.attr({"ng-repeat":"node in nodes","ui-tree-view-children":b.config.children}),f.$tpl=angular.element("<ul></ul>").append(c),b.$ps=b.$parent,b.depth=0,d.append(a(c.clone())(b))}}}}]),uis.directive("uiTreeViewChildren",["$compile","$timeout",function(a,b){return{restrict:"A",require:"^uiTreeView",link:function(c,d,e,f){var g=c.$new();g.nodes=c.node[e.uiTreeViewChildren],g.depth=c.depth+1,null!==g.nodes&&g.nodes.length>0&&b(function(){d.append(a(f.$tpl.clone())(g))},0)}}}]),uis.directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(b){return angular.isString(b)?void a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})}):angular.isArray(b)?void angular.forEach(b,function(b){a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})})}):void(angular.isObject(b)&&angular.forEach(b,function(b,c){angular.isString(b)&&a.$watch(b,function(){g[c](d.$modelValue)}),angular.isArray(b)&&angular.forEach(b,function(b){a.$watch(b,function(){g[c](d.$modelValue)})})}))}var f,g={},h=a.$eval(c.uiValidate);h&&(angular.isString(h)&&(h={validator:h}),angular.forEach(h,function(b,c){f=function(e){var f=a.$eval(b,{$value:e});return angular.isObject(f)&&angular.isFunction(f.then)?(f.then(function(){d.$setValidity(c,!0)},function(){d.$setValidity(c,!1)}),e):f?(d.$setValidity(c,!0),e):(d.$setValidity(c,!1),e)},g[c]=f,d.$formatters.push(f),d.$parsers.push(f)}),c.uiValidateWatch&&e(a.$eval(c.uiValidateWatch)))}}}),uis.directive("uiWeekdayInterval",["$translate",function(a){function b(b){var e,f=0,g=[],h=[],i=[];for(b=angular.copy(b),b.sort(),e=d;e<c.length;e++,f++)b.indexOf(e)>=0&&i.push({key:f,name:c[e]});for(e=0;d>e;e++,f++)b.indexOf(e)>=0&&i.push({key:f,name:c[e]});for(e=0;e<i.length;e++)"undefined"!=typeof i[e-1]&&i[e].key-i[e-1].key>1&&(g.push(i.splice(0,e)),e=0);for(i.length&&g.push(i),e=0;e<g.length;e++)1==g[e].length?h.push(a.instant("WEEK."+g[e][0].name)):2==g[e].length?h.push(a.instant("WEEK."+g[e][0].name),a.instant("WEEK."+g[e][1].name)):h.push(a.instant("WEEK."+g[e][0].name)+"-"+a.instant("WEEK."+g[e][g[e].length-1].name));return h}var c=["SU","MO","TU","WE","TH","FR","SA"],d=c.indexOf(a.instant("WEEK.FIRST_DAY"));return 0>d&&(d=0),{restrict:"AE",templateUrl:"ui-weekday-interval.html",replace:!0,scope:{model:"=uiModel"},link:function(a){a.$watch("model",function(c){a.intervals=b(c)})}}}]),uis.directive("uiWeekDay",["$translate",function(a){var b=["SU","MO","TU","WE","TH","FR","SA"],c=b.indexOf(a.instant("WEEK.FIRST_DAY"));return 0>c&&(c=0),{restrict:"AE",transclude:!0,replace:!0,templateUrl:"ui-weekday-switch.html",scope:{model:"=uiModel"},link:function(a){function d(a){var d,e=[];for(d=c;d<b.length;d++)e.push({key:d,name:b[d],selected:a.indexOf(d)>=0});for(d=0;c>d;d++)e.push({key:d,name:b[d],selected:a.indexOf(d)>=0});return e}a.toggle=function(b){var c=a.model.indexOf(b.key);c>=0?(a.model.splice(c,1),b.selected=!1):(a.model.push(b.key),a.model.sort(),b.selected=!0)},a.model||(a.model=[]),a.$watch("model",function(b){a.weekdays=d(b)})}}}]);})();